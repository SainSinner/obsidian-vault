Не понимаю как должна работать интеграция.
Понимаю вариант когда мы просто регулярно забираем какие-то пачки строк и по пачкам строк возвращаем ответ.

Вариант когда 1с не приняли порцию строк и строки которые мы пытались доставить изменились в DWH. Вероятно нам нужно упавшим запросом запускать синхронизацию вновь или этот упавший запрос должен актуализироваться. При этом новая порция данных не должна содержать в себе уже отправленные строки...
###### Статусы и их последовательность
1. "Забрали данные из optimacros" (OPT) - проставляем после того как вставили данные в OPTI
2. "Доставили в 1с"(DWH) - проставляем только после того как успешно передали данные в 1с
3. "Доставили в 1с"(OPT)