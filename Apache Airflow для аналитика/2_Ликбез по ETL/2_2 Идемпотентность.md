предыдущая [[2_2 Directed Acyclic Graph (DAG)]]
следующая [[2_2 Проектная работа ETL пайплайн простым методом.]]


**Теория:**

Идемпотентность - это свойство операции или функции, которое означает, что выполнение этой операции или функции несколько раз подряд или в разные моменты времени дает тот же результат, как если бы она была выполнена только один раз. В контексте программирования и обработки данных, идемпотентность подразумевает, что повторное применение операции к тем же данным не изменит результат или состояние данных после первого применения.

**Примеры**

Математика

- Сложение с нулем ((x+0)+0=x(x+0)+0=x. 
- Взятие модуля числа ∣(∣x∣)∣=x∣(∣x∣)∣=x

WEB (HTTP запросы)

- Метод GET является идемпотентным, так как мы всегда ожидаем один и тот же результат
- Метод DELETE всегда удаляет конкретное значение

**Идемпотентность в ETL и Airflow**

В данном блоке я позволю себе немного вольности, то что я опишу не является идемпотентностью в её классическом понимании. Однако этот термин хорошо подходит для описания некоторых особенностей работы с ETL и Airflow. 

Представим следующую ситуацию. Мы ежедневно запускаем скрипты которые учитывают дату запуска, то есть если например запуск скрипта осуществляется `2021-01-01` то наш скрипт будет это учитывать внутри кода (например при подстановке внутри SQL запроса нужной даты).

```sql
SELECT *
FROM table
WHERE date = '...' # Например 2021-01-01
```

И например, в какой то из дней наш скрипт не отработал, однако мы это заметили через несколько дней. Теперь нам необходимо перезагрузить данные... если наш скрипт не обладает свойством идемпотентности, то попытка перезапуска за  предыдущую дату вызовет дублирование данных, однако если мы учтем дату запуска как было описано выше. То дублирования данных не произойдет. Другими словами, запуск или перезапуск задачи для определенной даты в прошлом не должен зависеть от фактической даты запуска.

![](https://ucarecdn.com/37e0bb9b-9dc4-4611-9712-36b89a99ab81/)

Именно такую задачу нам поможет решить Airflow. Данный материал возможно покажется вам немного непонятным, но далее по курсу будет ссылка чтобы вы могли вернуться к нему, и тогда много для вас прояснится. Пока что просто запомните что есть термин идемпотентность, и наше немного вольное понимание данного термина.

**Полезные ссылки**

- [Лучшая статья про идемпотентностью которую я видел](https://habr.com/ru/company/yandex/blog/442762/)
- [Ещё одна отличная статья с большим разбором примеров](https://ru.hexlet.io/blog/posts/pochemu-vazhna-idempotentnost-i-kak-pisat-idempotentnye-bash-skripty)