предыдущая [[3_4 Jinja]]
следующая [[3_4 XCOM. Как передавать данные между задачами]]


Используя данный шаблон, подставьте код так чтобы DAG отработал. 

```python
from airflow import DAG
from airflow.operators.dummy_operator import DummyOperator
from airflow.operators.python_operator import PythonOperator
from datetime import datetime


def my_func(hello, date, **context):
  print(hello)
  print(date)
  print(<ВАШ КОД: Обратиться  через контекст к имени задачи>)


with DAG('<ВАШ ID>', schedule_interval='@daily',
          start_date=<ВАШ КОД: 2021-01-01>,
          end_date=<ВАШ КОД: 2021-01-10>) as dag:

  python_task    = PythonOperator(
    task_id='python_task',
    python_callable=my_func,
    op_kwargs= {
      'hello': <ВАШ КОД: передать строку Hello World>,
      'date': <ВАШ КОД: передать сюда дату запуска, через макрос>
      }
    )
```

**Задача**

Вам необходимо воспользоваться макросами чтобы airflow корректно обрабатывал задачу.

**Ответ**
```python
from airflow import DAG
from airflow.operators.python_operator import PythonOperator
from datetime import datetime


def my_func(hello, date, **context):
    print(hello)
    print(date)
    print(context["dag"])


with DAG('AirFlow_3_4_context_work', schedule_interval='@daily',
         start_date=datetime(2021, 1, 1),
         end_date=datetime(2021, 1, 10)) as dag:
    python_task = PythonOperator(
        task_id='python_task',
        python_callable=my_func,
        op_kwargs={
            'hello': 'Hello World',
            'date': '{{ ds }}'
        }
    )
```