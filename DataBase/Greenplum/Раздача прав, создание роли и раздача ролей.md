###### Протестил вопрос правами, пришел к следующему.  
Создаю роль.  
```sql
CREATE ROLE analytics;  
```
Для роли навешиваю права которые хочу, например только на просмотр и select по таблицам и представлениям.  
Скриптом ниже проходимся по всем схемам кроме служебных и тех к которым не хотим давать права.  
Далее чтобы добавить нового пользователя и дать ему права роли нужно следующее  
```sql
CREATE USER lmusaeva;  
GRANT ldap_users TO lmusaeva;  
GRANT analytics TO lmusaeva;  
```
  
минусы:  
1. нельзя дать права только на представления не дав права на исторические таблицы  
2. при добавлении новой схемы нужно выдавать права на новую схему, как давать права на все будущие схемы я не понял.

###### Почему необходимо пользоваться ролями?  
Потому что если мы захотим давать каждому пользователю индивидуальный набор прав, то при желании удалить его нам придется сначала отобрать все права и только потом удалить его, намного проще исключить его из какой-то группы.  
  
###### Как удалить пользователя/роль?  
Если мы захотели удалить эту роль, то нужно сначала отобрать у нее все права, пример скрипта на это ниже.

```sql
-- region Права на просмотр на определенную схему  
DO $$  
    DECLARE  
        user_name   text := 'analytics';  
        db_name     text := 'main';  
        schema_name text := 'ad_cur';  
        r_view      record;  
        r_table     record;  
    BEGIN  
        -- Права на присоединение к базе  
        EXECUTE 'GRANT CONNECT ON DATABASE ' || db_name || ' TO ' || user_name;  
        -- Права на просмотр всего что есть в схеме  
        EXECUTE 'GRANT USAGE ON SCHEMA ' || schema_name || ' TO ' || user_name;  
        -- Права на каждую созданную в будущем таблицу в схеме  
        EXECUTE 'ALTER DEFAULT PRIVILEGES IN SCHEMA ' || schema_name || ' GRANT SELECT ON TABLES TO ' || user_name;  
        -- Права на каждое существующее представление в схеме  
        FOR r_view IN (SELECT  
                           schemaname  
                         , viewname  
                       FROM  
                           pg_views  
                       WHERE  
                           schemaname = schema_name  
                      )  
            LOOP  
                EXECUTE 'GRANT SELECT ON TABLE ' || r_view.schemaname || '.' || r_view.viewname || ' TO ' || user_name;  
            END LOOP;  
        -- Права на каждую существующую таблицу в схеме  
        FOR r_table IN (SELECT  
                            schemaname  
                          , tablename  
                        FROM  
                            pg_tables  
                        WHERE  
                            schemaname = schema_name  
                       )  
            LOOP  
                EXECUTE 'GRANT SELECT ON TABLE ' || r_table.schemaname || '.' || r_table.tablename || ' TO ' ||  
                        user_name;  
            END LOOP;  
    END $$;  
  
-- endregion  
-- region Права на просмотр всех схем за исключением TOAST и служебных  
DO $$  
    DECLARE  
        user_name text := 'analytics';  
        db_name   text := 'main';  
        r_schema  record;  
        r_view    record;  
        r_table   record;  
    BEGIN  
        -- Права на присоединение к базе  
        EXECUTE 'GRANT CONNECT ON DATABASE ' || db_name || ' TO ' || user_name;  
        -- Цикл по всем пользовательским схемам  
        FOR r_schema IN (SELECT  
                             nspname  
                         FROM  
                             pg_namespace  
                         WHERE  
                               nspname NOT IN ('pg_catalog', 'information_schema') -- Исключаем служебные схемы  
                           AND nspname NOT LIKE 'pg_toast%' -- Исключаем схемы TOAST  
                           AND nspname NOT LIKE 'pg_temp%' -- Исключаем схемы pg_temp  
            -- AND (nspname LIKE '%_cur' OR nspname LIKE '%_export') -- Сокращаем до представлений                        )  
            LOOP  
                -- Права на просмотр всего что есть в схеме  
                EXECUTE 'GRANT USAGE ON SCHEMA ' || r_schema.nspname || ' TO ' || user_name;  
  
                -- Права на каждую созданную в будущем таблицу в схеме  
                EXECUTE 'ALTER DEFAULT PRIVILEGES IN SCHEMA ' || r_schema.nspname || ' GRANT SELECT ON TABLES TO ' ||  
                        user_name;  
  
                -- Права на каждое существующее представление в схеме  
                FOR r_view IN (SELECT  
                                   viewname  
                               FROM  
                                   pg_views  
                               WHERE  
                                   schemaname = r_schema.nspname  
                              )  
                    LOOP  
                        EXECUTE 'GRANT SELECT ON TABLE ' || r_schema.nspname || '.' || r_view.viewname || ' TO ' ||  
                                user_name;  
                    END LOOP;  
  
                -- Права на каждую существующую таблицу в схеме  
                FOR r_table IN (SELECT  
                                    tablename  
                                FROM  
                                    pg_tables  
                                WHERE  
                                    schemaname = r_schema.nspname  
                               )  
                    LOOP  
                        EXECUTE 'GRANT SELECT ON TABLE ' || r_schema.nspname || '.' || r_table.tablename || ' TO ' ||  
                                user_name;  
                    END LOOP;  
            END LOOP;  
    END $$;  
  
-- endregion  
-- region Отбираем права все права по всем схемам за исключением TOAST и служебных  
DO $$  
    DECLARE  
        user_name text := 'analytics';  
        db_name   text := 'main';  
        r_schema  record;  
        r_view    record;  
        r_table   record;  
    BEGIN  
        -- Цикл по всем пользовательским схемам  
        FOR r_schema IN (SELECT  
                             nspname  
                         FROM  
                             pg_namespace  
                         WHERE  
                               nspname NOT IN ('pg_catalog', 'information_schema') -- Исключаем служебные схемы  
                           AND nspname NOT LIKE 'pg_toast%' -- Исключаем схемы TOAST  
                           AND nspname NOT LIKE 'pg_temp%' -- Исключаем схемы pg_temp  
            -- AND (nspname LIKE '%_cur' OR nspname LIKE '%_export') -- Сокращаем до представлений                        )  
            LOOP  
                -- Права на каждую созданную в будущем таблицу в схеме  
                EXECUTE 'ALTER DEFAULT PRIVILEGES IN SCHEMA ' || r_schema.nspname || ' REVOKE SELECT ON TABLES FROM ' ||  
                        user_name;  
  
                -- Права на каждое существующее представление в схеме  
                FOR r_view IN (SELECT  
                                   viewname  
                               FROM  
                                   pg_views  
                               WHERE  
                                   schemaname = r_schema.nspname  
                              )  
                    LOOP  
                        EXECUTE 'REVOKE ALL PRIVILEGES ON TABLE ' || r_schema.nspname || '.' || r_view.viewname || ' FROM ' ||  
                                user_name;  
                    END LOOP;  
  
                -- Права на каждую существующую таблицу в схеме  
                FOR r_table IN (SELECT  
                                    tablename  
                                FROM  
                                    pg_tables  
                                WHERE  
                                    schemaname = r_schema.nspname  
                               )  
                    LOOP  
                        EXECUTE 'REVOKE ALL PRIVILEGES ON TABLE ' || r_schema.nspname || '.' || r_table.tablename || ' FROM ' ||  
                                user_name;  
                    END LOOP;  
                -- Права на просмотр всего что есть в схеме  
                EXECUTE 'REVOKE USAGE ON SCHEMA ' || r_schema.nspname || ' FROM ' || user_name;  
            END LOOP;  
        -- Права на присоединение к базе  
        EXECUTE 'REVOKE CONNECT ON DATABASE ' || db_name || ' FROM ' || user_name;  
    END $$;  
-- endregion
```